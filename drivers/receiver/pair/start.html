<link rel="stylesheet" href="/manager/webserver/assets/font/fontawesome/fontawesome.css">

<script type="text/javascript">

Homey.setTitle( __('pair.start.title') );

// front-end
Homey.emit( 'start', { 'foo': 'bar' }, function( err, result ){
    console.log(result); // result is Started!
});

Homey.on('done', function (data) {
	
	if (typeof data[0] === 'undefined') {
		
		document.getElementById('discovery').style.display = 'none';
		document.getElementById('manualpair').style.display = 'block';	
		
	} else {
		
		Homey.showView('list_devices');
	}
	
});

Homey.on('fill', function(data) {

	$('#Name').val(data[0]['name']);
	$('#ipAddress').val(data[0]['ip']);
	
	document.getElementById('tempdata').innerHTML = JSON.stringify(data);
	
});

Homey.on('continue', function( success, callback ){
		Homey.showView('list_devices');
})

function saveSettings () {
	
	$('#save').prop('disabled', true);
	Homey.addDevice({
	    data: { // this data object is saved to- and unique for the device. It is passed on the get and set functions as 1st argument
	        id: $('#ipAddress').val()
	    },
	    settings: {
		    'ipaddress': $('#ipAddress').val()
	    },
	    name: $('#Name').val(),
	    capabilities: [
        	'onoff'/*,
        	'dim',
        	{
                "id": "my_capability",
                "type": "number",
                "title": {
                    "en": "My Capability"
                },
                "units": {
                    "en": "Emiles"
                },
                "desc": {
                    "en": "Amount of Emiles per Emile"
                },
                "decimals": 2,
                "getable": true,
                "setable": true
            }*/
        ]
	}, function( err, result ){
	    if( err ) return console.error(err);
	    console.log( result);
	    
	    Homey.done();
	});
	//Homey.emit('get_devices', data);
	
}
</script>
	<style>
		#pairSettings {
			font-size:16px;
			border:none;
		}

		input {
			font-size:16px;
		}

	</style>
	
	<div id="discovery">
		<p data-i18n="pair.start.discovery"></p>
	</div>
	<div id="manualpair" style='display: none'>
    	<p data-i18n="pair.start.intro">enter IP address</p>
		
		<div id="tempdata">
			
		</div>

		<table id="pairSettings">
			<tr>
				<td style="width:100px;" data-i18n="pair.start.Name">Name</td>
				<td><input id="Name" type="text" value="" placeholder="TX-NR..."/></td>
			</tr>
			<tr>
				<td style="width:100px;" data-i18n="pair.start.ipAddress">IP</td>
				<td><input id="ipAddress" type="text" value="" placeholder="192.168.1.123"/></td>
			</tr>
		</table>
	</div>
	
		<p>
		&nbsp;
	  </p>

<fieldset>
    <button class="button" id="save" data-i18n="pair.start.saveSettings" onclick="saveSettings()">Save</button>
</fieldset>
